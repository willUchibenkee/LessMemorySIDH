#pragma once
#ifndef ISOGENY_H
#define ISOGENY_H
#endif

#include "efp2.h"
#include <gmp.h>

#define Pax0 "48CB469627ED504A5CD26186AB9EE150E961BBB20C50847C5F70951962AF75640E3AE63DE6716C4C7A0F0A92E663030350F0E1C5CF3C00"
#define Pax1 "50EAE369F84652707DC923D84780D680FE109424C46C81A884D22623B21C9489D1C6FA9D3B3D570EF62045928A6DDAED4078AE1C1CAD01"

#define Pay0 "00000A00000000000000290000003A00000010000000000000004100000040000000020000000000000000000000000000000000000000"
#define Pay1 "0000007C000000770000006E0000005D0000003F00000000000000801B1484A57F00003F000000000000000004000000000000B0FFFFFF"

#define Qax0 "6C0CEB0DBC2ADD7DEF37B2643FE158C0D7F442BD71ABB4C6EDA21AF361F4D964B6C02DD4AFF3F738EB66F688E39CF0FC0E34381746C700"
#define Qax1 "F5851CD6E2327419477851AE7242AFEA8372E2A140CDC414262BFA57692EA31AD3C2FB8615477EA6B42A68D00D325DD7507F1537DE2500"

#define Qay0 "000000000000000000000D5DFF83A57F00000100000000000000FB09FF83A57F00000000000000000000FF0F00000000000000C0DC0100"
#define Qay1 "00000000F0FFFFFFFFFFFF0010000000000000000000000000000001000000000000000000000000000000D0742984A57F0000801B1484"

#define Pbx ""
#define Pby ""

#define Qbx ""
#define Qby ""

#define ka "B"
#define kb "2"
#define eA 4 //216
#define eB 3 //137
#define la 2
#define lb 3
#define Aval0 "6"
#define Aval1 "0"

void Isogeny_set_a0(void);
void Isogeny_set_e(void);
void Isogeny_gets(efp2_t *S, efp2_t *P, efp2_t *Q, mpz_t k, fp2_t *ap);
void Isogeny_changea(fp2_t *nexta, fp2_t *alpha);
void Isogeny_changeb(fp2_t *nexta, fp2_t *beta, fp2_t *olda);
void Isogeny_nextp(efp2_t *ans, efp2_t *P, fp2_t *alpha, int l);
void Isogeny_mgec3(efp2_t *R, efp2_t *P, fp2_t *ap);
void isogeny_getj(fp2_t *jval, fp2_t *A);